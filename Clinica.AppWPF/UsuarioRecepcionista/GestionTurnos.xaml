<Window
	x:Class="Clinica.AppWPF.UsuarioRecepcionista.SecretariaTurnos"
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
	xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
	mc:Ignorable="d"
	Title="Clinica Medica – Gestión Integral"
	WindowStartupLocation="CenterScreen"
	Width="1024"
	Height="600"
	Icon="pack://application:,,,/PublishedResources/icons/icono.png">
	<!-- Fondo -->
	<Window.Background>
		<ImageBrush
			ImageSource="pack://application:,,,/PublishedResources/images2025sol/fondoCeleste2025.jpg"
			Stretch="Fill" />
	</Window.Background>
	<!-- ===================== LAYOUT GENERAL ===================== -->
	<Grid
		Margin="20">
		<Grid.RowDefinitions>
			<RowDefinition
				Height="Auto" />
			<!-- Título -->
			<RowDefinition
				Height="*" />
			<!-- Contenido -->
			<RowDefinition
				Height="Auto" />
			<!-- Botones inferiores -->
		</Grid.RowDefinitions>
		<Grid.ColumnDefinitions>
			<ColumnDefinition
				Width="2*" />
			<!-- Búsqueda + lista -->
			<ColumnDefinition
				Width="*" />
			<!-- Estado del turno -->
		</Grid.ColumnDefinitions>
		<!-- ===== TÍTULO ===== -->
		<Label
			Grid.Row="0"
			Grid.ColumnSpan="2"
			Style="{StaticResource LabelLindoConPiu}"
			Content="Gestión Turnos"
			FontWeight="Bold"
			HorizontalContentAlignment="Center"
			Margin="45,0,45,15"
			FontSize="45" />
		<!-- ===== PANEL IZQUIERDO: BUSCAR TURNOS ===== -->
		<Grid
			Grid.Row="1"
			Grid.Column="0">
			<Grid.RowDefinitions>
				<RowDefinition
					Height="Auto" />
				<!-- Título -->
				<RowDefinition
					Height="Auto" />
				<!-- Filtros -->
				<RowDefinition
					Height="*" />
				<!-- ListView -->
			</Grid.RowDefinitions>
			<Label
				Content="Listado"
				FontSize="25"
				FlowDirection="RightToLeft"
				Style="{StaticResource LabelLindoConTextoSombra}"
				HorizontalContentAlignment="Center"
				VerticalContentAlignment="Center"
				VerticalAlignment="Center"
				Margin="25,0,25,0"
				FontWeight="Bold" />
			<!-- FILTROS -->
			<Grid
				Grid.Row="1"
				Margin="0,0,0,10">
				<Grid.ColumnDefinitions>
					<ColumnDefinition
						Width="auto" />
					<ColumnDefinition
						MinWidth="160" />
					<ColumnDefinition
						MinWidth="160" />
					<ColumnDefinition
						MinWidth="160" />
				</Grid.ColumnDefinitions>
				<!-- Filtro paciente -->
				<StackPanel
					Grid.Column="0"
					HorizontalAlignment="Center"
					VerticalAlignment="Center">
					<Button
						Click="ClickBoton_Refrescar"
						Grid.Row="1"
						Style="{StaticResource BotonRefrescar}"></Button>
				</StackPanel>
				<StackPanel
					Grid.Column="1"
					Margin="5">
					<Label
						Content="Filtrar por Estado:"
						FontFamily="Palatino Linotype"
						Margin="5"
						FontWeight="Bold"
						FontSize="15" />
					<ComboBox
						ItemsSource="{Binding Estados}"
						Margin="5"
						SelectedItem="{Binding EstadoSeleccionado}" />
				</StackPanel>
				<StackPanel
					Grid.Column="2"
					Margin="5">
					<Label
						Content="Filtrar por paciente:"
						Margin="5"
						FontFamily="Palatino Linotype"
						FontWeight="Bold"
						FontSize="15" />
					<TextBox
						Margin="5"
						Text="{Binding FiltroTurnosPaciente, UpdateSourceTrigger=PropertyChanged}" />
				</StackPanel>
				<!-- Filtro estado -->
				<!-- Filtro médico -->
				<StackPanel
					Grid.Column="3"
					Margin="5">
					<Label
						Content="Filtrar por Médico:"
						Margin="5"
						FontFamily="Palatino Linotype"
						FontWeight="Bold"
						FontSize="15" />
					<TextBox
						Margin="5"
						Text="{Binding FiltroTurnosMedico, UpdateSourceTrigger=PropertyChanged}" />
				</StackPanel>
			</Grid>
			<!-- LISTA DE TURNOS -->
			<ListView
				Grid.Row="2"
				ItemsSource="{Binding TurnosView}"
				SelectedItem="{Binding SelectedTurno}"
				ScrollViewer.HorizontalScrollBarVisibility="Auto"
				ScrollViewer.VerticalScrollBarVisibility="Auto"
				Margin="10"
				FontSize="14">
				<ListView.View>
					<GridView>
						<!-- Paciente -->
						<GridViewColumn
							Width="Auto"
							DisplayMemberBinding="{Binding PacienteDisplayear}">
							<GridViewColumn.Header>
								<GridViewColumnHeader
									Content="Paciente"
									Click="ClickCabecera_OrdenarFilas"
									Tag="PacienteDisplayear" />
							</GridViewColumn.Header>
						</GridViewColumn>
						<!-- FechaSolicitud -->
						<GridViewColumn
							Width="Auto">
							<GridViewColumn.Header>
								<GridViewColumnHeader
									Content="FechaSolicitud"
									Click="ClickCabecera_OrdenarFilas"
									Tag="Original.FechaDeCreacion" />
							</GridViewColumn.Header>
							<GridViewColumn.CellTemplate>
								<DataTemplate>
									<TextBlock
										Text="{Binding Original.FechaDeCreacion, StringFormat={}{0:dd/MM/yyyy HH:mm}}" />
								</DataTemplate>
							</GridViewColumn.CellTemplate>
						</GridViewColumn>
						<!-- Especialidad -->
						<GridViewColumn
							Width="Auto"
							DisplayMemberBinding="{Binding Original.EspecialidadCodigo}">
							<GridViewColumn.Header>
								<GridViewColumnHeader
									Content="Especialidad"
									Click="ClickCabecera_OrdenarFilas"
									Tag="Original.EspecialidadCodigo" />
							</GridViewColumn.Header>
						</GridViewColumn>
						<!-- FechaAsignada -->
						<GridViewColumn
							Width="Auto">
							<GridViewColumn.Header>
								<GridViewColumnHeader
									Content="FechaAsignada"
									Click="ClickCabecera_OrdenarFilas"
									Tag="Original.FechaHoraAsignadaDesde" />
							</GridViewColumn.Header>
							<GridViewColumn.CellTemplate>
								<DataTemplate>
									<TextBlock
										Text="{Binding Original.FechaHoraAsignadaDesde, StringFormat={}{0:dd/MM/yyyy HH:mm}}" />
								</DataTemplate>
							</GridViewColumn.CellTemplate>
						</GridViewColumn>
						<!-- FechaAsignadaDiaSemana -->
						<GridViewColumn
							Width="Auto"
							DisplayMemberBinding="{Binding DiaSemana}">
							<GridViewColumn.Header>
								<GridViewColumnHeader
									Content="DiaSemana"
									Click="ClickCabecera_OrdenarFilas"
									Tag="DiaSemana" />
							</GridViewColumn.Header>
						</GridViewColumn>
						<!-- Médico -->
						<GridViewColumn
							Width="Auto"
							DisplayMemberBinding="{Binding MedicoDisplayear}">
							<GridViewColumn.Header>
								<GridViewColumnHeader
									Content="Médico"
									Click="ClickCabecera_OrdenarFilas"
									Tag="MedicoDisplayear" />
							</GridViewColumn.Header>
						</GridViewColumn>
						<!-- Estado -->
						<GridViewColumn
							Width="Auto"
							DisplayMemberBinding="{Binding Original.OutcomeEstado}">
							<GridViewColumn.Header>
								<GridViewColumnHeader
									Content="Estado"
									Click="ClickCabecera_OrdenarFilas"
									Tag="Original.OutcomeEstado" />
							</GridViewColumn.Header>
						</GridViewColumn>
						<!-- FechaConfirm. -->
						<GridViewColumn
							Width="Auto">
							<GridViewColumn.Header>
								<GridViewColumnHeader
									Content="FechaConfirm."
									Click="ClickCabecera_OrdenarFilas"
									Tag="Original.OutcomeFecha" />
							</GridViewColumn.Header>
							<GridViewColumn.CellTemplate>
								<DataTemplate>
									<TextBlock
										Text="{Binding Original.OutcomeFecha, StringFormat={}{0:dd/MM/yyyy HH:mm}}" />
								</DataTemplate>
							</GridViewColumn.CellTemplate>
						</GridViewColumn>
					</GridView>
				</ListView.View>
			</ListView>
		</Grid>
		<!-- ===== PANEL DERECHO: ESTADO DEL TURNO ===== -->
		<StackPanel
			Grid.Row="1"
			Grid.RowSpan="2"
			Grid.Column="1"
			Margin="0,10,0,10"
			HorizontalAlignment="Center">
			<Label
				Content="Turno seleccionado"
				FontSize="20"
				FlowDirection="RightToLeft"
				Style="{StaticResource LabelLindoConTextoSombra}"
				HorizontalContentAlignment="Center"
				VerticalContentAlignment="Center"
				VerticalAlignment="Center"
				Margin="20,0,20,0"
				FontWeight="Bold" />
			<Label
				Content="{Binding SelectedTurno.Original.OutcomeEstado}"
				FontSize="14"
				FontFamily="Palatino Linotype"
				FontWeight="Bold"
				Margin="15,5,15,15"
				Height="30"
				HorizontalAlignment="Center"
				VerticalAlignment="Center"
				MinWidth="100" />
			<Label
				Content="Comentario:"
				FontFamily="Palatino Linotype"
				FontWeight="Bold"
				HorizontalContentAlignment="Center"
				HorizontalAlignment="Center"
				VerticalAlignment="Center" />
			<Label
				x:Name="comentarioTextBox"
				Content="{Binding SelectedTurno.Original.OutcomeComentario}"
				Margin="5,5,5,10"
				Height="50"
				MinWidth="150"
				HorizontalContentAlignment="Center" />
			<Label
				Content="Fecha de conclusión:"
				FontFamily="Palatino Linotype"
				FontWeight="Bold"
				Margin="0,10,0,0"
				HorizontalAlignment="Center"
				HorizontalContentAlignment="Center" />
			<DatePicker
				SelectedDate="{Binding SelectedTurno.Original.OutcomeFecha}"
				IsEnabled="{Binding PuedeModificarTurnoSeleccionado}"
				Margin="0,5,0,10"
				HorizontalAlignment="Center" />
			<StackPanel
				Margin="0,15,0,0"
				HorizontalAlignment="Center"
				Orientation="Horizontal">
				<StackPanel>
					<Button
						Content="Concretar"
						Width="122"
						Height="32"
						IsEnabled="{Binding PuedeConfirmarTurno}"
						Style="{StaticResource BotonRedondeado}"
						Click="Button_ConfirmarTurnoAsistencia"
						Margin="7,7,7,7"
						FontSize="16" />
					<Button
						Content="Ausente"
						Width="122"
						Height="32"
						Margin="7,7,7,7"
						IsEnabled="{Binding PuedeMarcarComoAusente}"
						Style="{StaticResource BotonRedondeadoRojo}"
						Click="Button_MarcarTurnoAusente"
						FontSize="16"
						FontWeight="Bold" />
				</StackPanel>
				<StackPanel>
					<Button
						Content="Reprogramar"
						Width="122"
						Height="32"
						Margin="7,7,7,7"
						IsEnabled="{Binding PuedeCancelarTurno}"
						Style="{StaticResource BotonRedondeado}"
						Click="Button_ReprogramarTurno"
						FontSize="16" />
					<Button
						Content="Cancelar"
						Width="122"
						Height="32"
						IsEnabled="{Binding PuedeCancelarTurno}"
						Style="{StaticResource BotonRedondeadoRojo}"
						Click="Button_CancelarTurno"
						Margin="7,7,7,7"
						FontSize="16" />
				</StackPanel>
			</StackPanel>
		</StackPanel>
		<!-- ===== BOTONES INFERIORES (HOME / SALIR) ===== -->
		<StackPanel
			Grid.Row="2"
			Orientation="Horizontal"
			HorizontalAlignment="Left"
			Margin="15,15,15,15"
			Width="380"
			VerticalAlignment="Bottom">
			<Button
				Content="Home"
				Width="170"
				Height="37"
				Margin="10,0,10,10"
				Click="ClickBoton_Home"
				FontSize="20"
				Style="{StaticResource BotonRedondeado}" />
			<Button
				Content="Salir"
				Width="170"
				Height="37"
				Margin="10,0,10,10"
				Click="ClickBoton_Salir"
				FontSize="20"
				Style="{StaticResource BotonRedondeado}" />
		</StackPanel>
	</Grid>
</Window>
